Bengine.extensibles.qhtml=new function(){this.type="qhtml",this.name="html",this.category="quiz",this.upload=!1,this.accept=null;var e=this,t={makeShortcode:function(t,n){if(3===t.length){let n=['<input name="',"",'" type="',"",'" ',"",' style="width:100%;box-sizing:border-box;">'];n[1]=t[0];let l=t[1].split("-"),i="";2==l.length&&(i=l[1]);let r="",o=l[0].toLowerCase();if("checkbox"===o){let e='<label style="display:block" for="'+n[1]+'">';n[3]="checkbox",n[5]='id="'+n[1]+'" value="'+t[2].split(",")[0]+'"',r=e+n.join("")+t[2].split(",")[1]+"</label>"}else if("text"===o)n[3]="text",n[5]='placeholder="'+t[2]+'"',r=n.join("");else if("number"===o)n[3]="number",n[5]='placeholder="'+t[2]+'"',r=n.join("");else if("submit"===o)n[3]="submit",n[5]='value="'+t[2]+'"',r=n.join("");else if("reset"===o)n[3]="reset",n[5]='value="'+t[2]+'"',r=n.join("");else if("textarea"===o){let e="20";""!==i&&(e=i),r='<textarea name="'+n[1]+'" placeholder="'+t[2]+'" style="width:100%" rows="'+e+'"></textarea>'}else e.p.alerts.log("Invalid Qengine shortcode type: "+l[0],"error");return r}if(2===t.length){let n,l=e.p.getResourcePath(t[0]);if(void 0!==l){let e=t[1].toLowerCase();"audio"===e?n='<audio src="'+l+'"></audio>':"embed"===e?n='<embed src="'+l+'">':"image"===e?n='<img src="'+l+'">':"script"===e?n='<script src="'+l+'"><\/script>':"video"===e&&(n='<video src="'+l+'"></video>')}else n="";return n}return""},renderHTML:function(n,l){let i=e.p.replaceVars(n);var r='<div class="xQhtml-parent">'+t.replaceShortcodes(i)+"</div>";return l.innerHTML=r,l},replaceShortcodes:function(n){let l=/~~~(.*?)~~~/g;var i,r=n;do{if(i=l.exec(n)){let n,l=i[1].split(":");if(3!==l.length&&2!==l.length)n="",e.p.alerts.log("Invalid Qengine shortcode, must be: ~~~namespace.variable:TYPE[:extra]","error");else try{n=t.makeShortcode(l)}catch(t){n="",e.p.alerts.log("Qengine variable not found: "+i[1],"error")}r=r.replace(i[0],n)}}while(i);return r}};this.destroy=function(){},this.fetchDependencies=function(){return null},this.insertContent=function(t,n){var l=document.createElement("form");l.setAttribute("class","xQhtml-show"),l.onsubmit=function(t){t.preventDefault();let n=this.length;for(let t=0;t<n;t++){let n=this[t].name,l=this[t].value,i=n.split(/\.(.+)/).filter(function(e){return 0!=e.length});2===i.length?Object.keys(e.d.variables).includes(i[0])?e.d.variables[i[0]][i[1]]=l:(e.d.variables[i[0]]={},e.d.variables[i[0]][i[1]]=l):e.p.alerts.log("Invalid variable: "+n+", must be: namespace.variable")}return e.p.alerts.log("complete","success"),console.log(e.d.variables),null};var i=document.createElement("textarea");i.setAttribute("class","xQhtml");var r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("class","bengine-x-ns-cond col col-50"),r.setAttribute("placeholder","Block Namespace");var o=document.createElement("input");return o.setAttribute("type","text"),o.setAttribute("class","bengine-x-ns-cond col col-50"),o.setAttribute("placeholder","Block Conditional (optional)"),e.p.emptyObject(n)?i.innerText="<p>Place HTML Content Here</p>":(i.value=n.content,r.value=n.namespace,o.value=n.conditional),t.appendChild(l),t.appendChild(r),t.appendChild(o),t.appendChild(i),t},this.afterDOMinsert=function(e,n){var l=document.getElementById(e).childNodes[3];t.renderHTML(l.value,l.parentNode.childNodes[0])},this.runBlock=function(e){var n=document.getElementById(e).childNodes[3];t.renderHTML(n.value,n.parentNode.childNodes[0])},this.runData=function(n,l,i){e.p.checkConditional(n)&&l.contentDocument.body.children[0].appendChild(t.renderHTML(n.content,document.createElement("div"))),i.done=!0},this.saveContent=function(e){var t=document.getElementById(e).children[1].value,n=document.getElementById(e).children[2].value;return{content:document.getElementById(e).children[3].value,namespace:t,conditional:n}},this.saveFile=null,this.showContent=function(e,n){var l=document.createElement("div");l.setAttribute("class","xQhtml-show"),(i=document.createElement("div")).setAttribute("class","xQhtml"),i.setAttribute("style","display:none;visibility:hidden;"),i.innerHTML=n.content,e.appendChild(l),e.appendChild(i);var i=document.getElementById(bid).childNodes[3];return t.renderHTML(i.value,i.parentNode.childNodes[0]),e},this.styleBlock=function(){return".xQhtml {\n\t\t\tdisplay: inline-block;\n\t\t\twidth: 100%;\n\t\t\theight: 200px;\n\t\t\tborder: 1px solid black;\n\t\t\tbackground-color: white;\n\n\t\t\tpadding: 8px 6px;\n\t\t\tmargin: 0;\n\t\t\tbox-sizing: border-box;\n\n\t\t\tfont-family: Lucida Console, Monaco, monospace;\n\t\t\tfont-size: 0.8em;\n\t\t\tresize: vertical;\n\t\t}\n\n\t\t.xQhtml-show {\n\t\t\tdisplay: flex;\n\t\t\twidth: 100%;\n\t\t\theight: auto;\n\t\t\tmin-height: 64px;\n\t\t\tborder: 1px solid black;\n\t\t\tbackground-color: white;\n\n\t\t\tmargin: 0px;\n\t\t\tbox-sizing: border-box;\n\t\t\toverflow: hidden;\n\t\t}\n\t\t\n\t\t.xQhtml-parent {\n\t\t\tmargin: 0px;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t}"}};