Bengine.extensibles.files=new function(){this.type="files",this.name="files",this.category="quiz",this.upload=!1,this.accept=null;var e=this;_private={fileBlobs:{}},_private.getFiles=function(t,n,i){let l=n.replace(/ /g,"").replace(/\n$/,""),a=[];l.length>0&&(a=l.split(/\n|,/g));let o={fpath:e.d.getPagePath(),files:a,namespace:t};e.p.sendData("/files",o).then(function(n){if(Object.keys(n.data.files).length>0)for(key in e.d.variables[t]=n.data.files,e.p.alerts.log("complete","success"),n.data.files)e.p.getLocalResource(key,n.data.files[key]).then(function(e){_private.fileBlobs[e.name]=e}).catch(function(t){e.p.alerts.log("File not available for engine file download. Could not get "+t,"error")});i&&(i.done=!0)},function(t){e.p.alerts.alert(t.msg),i&&(i.done=!0)})},this.destroy=function(){},this.fetchDependencies=function(){return null},this.insertContent=function(t,n){var i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("class","bengine-x-ns-cond col col-50"),i.setAttribute("placeholder","Enter The Namespace For This Files Block.");var l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("class","bengine-x-ns-cond col col-50"),l.setAttribute("placeholder","Block Conditional (optional)");var a=document.createElement("textarea");return a.setAttribute("class","xFiles"),a.setAttribute("placeholder","Comma or newline separated files to retrieve."),e.p.emptyObject(n)||(a.value=n.content,i.value=n.namespace,l.value=n.conditional),t.appendChild(i),t.appendChild(l),t.appendChild(a),t},this.afterDOMinsert=function(e,t){_private.getFiles(document.getElementById(e).childNodes[0].value,document.getElementById(e).childNodes[2].value,null)},this.runBlock=function(e){_private.getFiles(document.getElementById(e).childNodes[0].value,document.getElementById(e).childNodes[2].value,null)},this.runData=function(t,n,i){e.p.checkConditional(t)?_private.getFiles(t.namespace,t.content,i):i.done=!0},this.saveContent=function(e){var t=document.getElementById(e).children[0].value.trim(),n=document.getElementById(e).children[1].value.trim();return{content:document.getElementById(e).children[2].value,namespace:t,conditional:n}},this.saveFile=function(t){var n=[],i=document.getElementById(t).children[2].value.split("\n");for(path of i){path.trim();path.length>0&&path.indexOf("http")<0&&(_private.fileBlobs[path]?n.push(_private.fileBlobs[path]):e.p.alerts.alert("The <b>"+path+"</b> file has not been retrieved. Run the file block to retrieve them if you want to save those files."))}return n},this.showContent=function(e,t){return e},this.styleBlock=function(){return".xFiles {\n\t\t\tmax-width: 100%;\n\t\t\tmargin: 0px auto 0 auto;\n\t\t\twidth: 100%;\n\t    \theight: 100px;\n\t    \tborder: 1px solid black;\n\t    \tborder-radius: 2px;\n\t    \tbackground-color: white;\n\t\n\t    \tpadding: 8px;\n\t    \tmargin: 0px;\n\t    \tbox-sizing: border-box;\n\t\n\t    \tfont-family: Arial, Helvetica, sans-serif;\n\t    \tfont-size: 1em;\n\t    \tfont-weight: 300;\n\t    \tcolor: black;\n\t\t}"}};